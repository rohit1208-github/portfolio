(()=>{var e={};e.id=276,e.ids=[276],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1630:e=>{"use strict";e.exports=require("http")},1645:e=>{"use strict";e.exports=require("net")},1997:e=>{"use strict";e.exports=require("punycode")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4075:e=>{"use strict";e.exports=require("zlib")},4631:e=>{"use strict";e.exports=require("tls")},4735:e=>{"use strict";e.exports=require("events")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5511:e=>{"use strict";e.exports=require("crypto")},5591:e=>{"use strict";e.exports=require("https")},6487:()=>{},6941:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>g,routeModule:()=>m,serverHooks:()=>v,workAsyncStorage:()=>h,workUnitAsyncStorage:()=>x});var s={};r.r(s),r.d(s,{POST:()=>l,runtime:()=>d});var n=r(6559),o=r(8088),a=r(7719),i=r(2190),u=r(7450);let c=new(r(7449)).ij(process.env.GOOGLE_API_KEY).getGenerativeModel({model:"gemini-1.5-pro"});async function p(e,t,r){let s=t.join("\n\n"),n=r.map(e=>({role:"user"===e.role?"user":"model",parts:[{text:e.content}]})),o=c.startChat({history:n,generationConfig:{temperature:.3,topP:.8,topK:40,maxOutputTokens:2048}}),a=`You are an AI assistant for a job candidate. Your purpose is to answer questions that hiring managers and recruiters might have about the candidate based on their resume and other professional documents. 
  Only answer questions based on the provided context. If you don't have enough information in the context, say so honestly.
  
  Here is the relevant information from the candidate's documents:
  ${s}`;return(await o.sendMessage(a+"\n\nUser question: "+e)).response.text()}let d="nodejs";async function l(e){try{let{message:t,history:r}=await e.json(),s=(await (0,u.N)(t)).map(e=>e.pageContent),n=await p(t,s,r);return i.NextResponse.json({response:n})}catch(e){return console.error("Error in chat route:",e),i.NextResponse.json({error:"Failed to process your request"},{status:500})}}let m=new n.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/chat/route",pathname:"/api/chat",filename:"route",bundlePath:"app/api/chat/route"},resolvedPagePath:"/Users/samjoshuva/Downloads/personal-rag-bot/app/api/chat/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:h,workUnitAsyncStorage:x,serverHooks:v}=m;function g(){return(0,a.patchFetch)({workAsyncStorage:h,workUnitAsyncStorage:x})}},7450:(e,t,r)=>{"use strict";r.d(t,{j:()=>l,N:()=>m});var s=r(9326),n=r(2125),o=r(7449),a=r(6345);let i=process.env.SUPABASE_SERVICE_ROLE_KEY,u=(0,a.UU)("https://bvbtsfcgiauheudzbfvr.supabase.co",i,{auth:{persistSession:!1}});var c=r(4420);class p{constructor(e){this.caller=void 0,this.model=new o.ij(e)}async embedQuery(e){let t=this.model.getGenerativeModel({model:"embedding-001"});return(await t.embedContent(e)).embedding.values}async embedDocuments(e){let t=[];for(let r of e){let e=await this.embedQuery(r);t.push(e)}return t}}let d=new p(process.env.GOOGLE_API_KEY);async function l(e,t){let r=[];if(t.endsWith(".md")){let s=e.toString("utf-8");r=[new c.y({pageContent:s,metadata:{source:t}})]}else throw Error("Unsupported file type");let o=new n.Q({chunkSize:1e3,chunkOverlap:200}),a=await o.splitDocuments(r);return console.log("vectorStore :",await s.l.fromDocuments(a,d,{client:u,tableName:"document_embeddings",queryName:"match_documents"})),{documentId:t,chunkCount:a.length}}async function m(e){let t=new s.l(d,{client:u,tableName:"document_embeddings",queryName:"match_documents"});return await t.similaritySearch(e,5)}},7598:e=>{"use strict";e.exports=require("node:crypto")},7910:e=>{"use strict";e.exports=require("stream")},8335:()=>{},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9428:e=>{"use strict";e.exports=require("buffer")},9551:e=>{"use strict";e.exports=require("url")}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,580,691],()=>r(6941));module.exports=s})();